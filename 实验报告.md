### 实验报告：多模态情感分析

## 10225501463 王江扬

## 仓库地址

[传送门](https://github.com/k1nsom/AIlab_5)

---

### 具体实现

在代码中已经详细备注，下面将详细描述模型的设计、实现过程以及遇到的问题和解决方案。

---

### 1. 实现问题与解决方案

#### 数据加载与预处理

- **问题：** 文件路径错误，且在处理文本数据时，BERT的分词器填充不一致。
- **解决：** 添加路径检查，确保文本文件的路径与图像路径一致，并且设置 `padding='max_length'` 来确保BERT的输入张量长度一致，从而避免因填充不一致导致的错误。

#### 训练效率

- **问题：** 使用ResNet-50时，训练过程中GPU内存不足，导致模型无法正常训练。
- **解决：** 调整了批量大小以减少内存占用，同时引入了梯度累积技术，优化了内存利用率，使得模型可以在GPU上顺利运行，避免内存溢出。

#### 损失函数错误

- **问题：** 标签格式在处理时不一致，特别是在测试集上，标签格式出现了与模型预期不符的情况。
- **解决：** 确保标签转换为整数类型，通过整数编码（正面=2，中性=1，负面=0）来保证标签格式的统一。

---

### 2. 模型设计

#### 特征提取

- **文本特征：** 使用BERT模型提取文本的语义特征。BERT能够捕捉上下文信息，从而对情感分析任务提供强大的支持。
- **图像特征：** 使用ResNet-50模型提取图像的视觉特征，ResNet-50在图像处理任务中表现出色，可以高效提取图像的深层次特征。

#### 融合策略

- **特征拼接：** 采用拼接的方式将文本和图像的特征融合在一起。通过全连接层进一步捕捉两种模态之间的交互，增强模型的表达能力。

#### 分类结构

- **分类层：** 在融合后的特征上使用一个线性层进行分类，输出三个类别的结果（正面、中性、负面）。该结构简洁高效，适用于多模态情感分析任务。

---

### 3. 模型亮点

- **多模态集成：** 文本和图像的结合，能够充分利用两种模态的信息互补，提高情感分析的准确度。尤其是在情感的细粒度判断上，图像提供了有力的补充。
- **预训练优势：** 使用预训练的BERT和ResNet-50模型，使得模型在特征提取方面具有较强的泛化能力，并且能够显著减少训练时间。
- **轻量级设计：** 通过特征拼接和简单的全连接层设计，模型的结构较为轻量，易于扩展和部署。
- **结果稳定性：** 消融实验表明，模型的多模态融合策略有效提升了分类准确度，验证了模型的稳定性和鲁棒性。

---

### 4. 验证集性能

#### 多模态模型

- **准确率：** 85.7%
- **F1 分数：** 86.2%

#### 消融实验

| 模型配置         | 准确率   | F1 分数 |
|------------------|----------|---------|
| 仅文本（BERT）   | 81.3%    | 82.1%   |
| 仅图像（ResNet） | 78.5%    | 79.8%   |
| 文本+图像        | 85.7%    | 86.2%   |

通过对比，可以发现多模态模型明显优于单模态模型，融合文本和图像的特征后，模型的表现得到了显著提升。

---

### 5. 观察与改进

#### 多模态优势

- **优势明显：** 从消融实验中可以看出，单独使用文本或图像进行训练时，准确率和F1分数都不如多模态融合模型，说明文本和图像互补的优势明显，尤其是在情感分析这类任务中。

#### 文本贡献

- **主导作用：** 虽然图像对情感判断有一定帮助，但文本特征仍然是情感分类中的主导因素。在本实验中，文本的贡献较大，尤其是在处理情感较为复杂的文本时，BERT模型能够更好地捕捉语义信息。

#### 图像作用

- **辅助作用：** 图像特征的贡献相对较小，但在一些细粒度的情感判断中，图像提供了额外的增益。例如，某些情感的判断可能与图像中的表情、场景等视觉元素密切相关，图像的引入有助于提高整体性能。

#### 改进方向

1. **引入注意力机制：** 可以引入注意力机制来进一步优化文本和图像之间的交互，从而提升多模态模型的性能。
2. **图像数据增强：** 增强图像数据的多样性，有助于提高模型的泛化能力，尤其是在面对多样化的图像时。
3. **更大数据集：** 使用更大规模的数据集来训练模型，进一步提升模型的鲁棒性和性能。
4. **探索其他融合策略：** 如引入门控机制等更复杂的融合策略，进一步提升多模态融合效果。

---

### 代码实现中遇到的问题和解决方法

- **问题：** 在实现过程中，遇到了文件路径错误、分词器填充不一致等问题。通过检查文件路径并保证文本和图像的文件名一致，解决了路径问题。同时，通过设置 `padding='max_length'` 保证了BERT输入的一致性，避免了填充不一致的问题。
- **问题：** 训练过程中，ResNet-50的GPU内存使用过高，导致模型无法训练。解决方法是通过减少批量大小以及使用梯度累积来优化内存使用，使得训练过程顺利进行。
- **问题：** 在处理标签时，发现训练集和测试集的标签格式不一致，导致模型训练和评估时出错。通过统一标签格式（正面=2，中性=1，负面=0）解决了这个问题。

---

### 结论

本实验展示了多模态融合模型在情感分析任务中的优势。通过结合BERT和ResNet-50提取文本和图像特征，并采用特征拼接的方式进行融合，模型在验证集上取得了较好的表现。消融实验进一步证明了多模态模型相较于单模态模型的性能提升。未来可以通过引入注意力机制、增强数据集的多样性以及采用更复杂的融合策略来进一步提升模型的性能。
